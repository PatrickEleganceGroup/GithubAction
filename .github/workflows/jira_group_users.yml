name: Jira Group Users

on:
  workflow_dispatch:
    inputs:
      projectKey:
        description: "Project key from Atlassian Automation (e.g. ABC)"
        required: true
      issueKey:
        description: "Jira issue key to comment on (e.g. ABC-123)"
        required: true

jobs:
  retrieve-and-comment:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v3
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: pip install requests

      - name: Run script to get users and post comment
        run: python .github/workflows/jira_group_users.py
        env:
          # The inputs come from "workflow_dispatch" inputs
          PROJECT_KEY: ${{ github.event.inputs.projectKey }}
          ISSUE_KEY: ${{ github.event.inputs.issueKey }}

          # Pre-encoded basic auth token
          BASIC_AUTH: ${{ secrets.JIRA_BASIC_AUTH }}
