name: Jira Group Users

on:
  workflow_dispatch:
    inputs:
      projectKey:
        description: "Project key from Atlassian Automation (e.g. ABC)"
        required: true
      issueKey:
        description: "Jira issue key to comment on (e.g. ABC-123)"
        required: true

jobs:
  retrieve-and-comment:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v3
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: pip install requests

      - name: Run script to get users and post comment
        run: python scripts/jira_group_users.py
        env:
          # These inputs come from the workflow_dispatch event
          PROJECT_KEY: ${{ github.event.inputs.projectKey }}
          ISSUE_KEY: ${{ github.event.inputs.issueKey }}

          # This is your pre-encoded Basic token, stored as a GitHub secret
          # For example, secret name: JIRA_BASIC_AUTH
          BASIC_AUTH: ${{ secrets.JIRA_BASIC_AUTH }}

          # The base Jira domain
          JIRA_SITE: "https://prudential-ps.atlassian.net"
